create table shop(id int auto_increment primary key,name varchar(50),address varchar(100),
tel varchar(30),email varchar(100),img_path varchar(1000),img_title varchar(1000),date_shop date);

create table status(id int primary key,name varchar(50));

create table employees(emp_id varchar(10) primary key,emp_name varchar(50),emp_surname varchar(50),gender varchar(10),
dob date,address varchar(100),tel varchar(30),email varchar(100),pass varchar(24),status int,work_start date,end_work date,
img_path varchar(1000),foreign key(status) references status(id));

create table customers(cus_id int auto_increment primary key,cus_name varchar(50),cus_surname varchar(50),
address varchar(100),tel varchar(30),email varchar(100),tel_app varchar(30));

create table suppliers(sup_id int auto_increment primary key,company varchar(50),tel varchar(30),
fax varchar(30),address varchar(100),email varchar(100));

create table category(cate_id int auto_increment primary key,cate_name varchar(50),img_path varchar(1000));
create table categorydetail(cated_id int auto_increment primary key,cated_name varchar(50));

create table unit(unit_id int auto_increment primary key,unit_name varchar(50));

create table brand(brand_id int auto_increment primary key,name varchar(50));

create table model(model_id int auto_increment primary key,name varchar(50));

create table pro_detail_static(id int primary key,name varchar(50));

create table credit_card(card_id varchar(30) primary key,ac_no varchar(30),img_path varchar(100));

create table delivery(deli_id int auto_increment primary key,deli_name varchar(50),img_path varchar(1000));

create table rate(rate_id varchar(10),rate_buy decimal(11,2),rate_sell decimal(11,2));

create table cupon(cupon_key varchar(30) primary key, qty int,price decimal(11,2));

create table product(pro_id varchar(30) primary key,pro_name varchar(50),qty int,price decimal(11,2),
cated_id int,unit_id int,brand_id int,guarantee int,type varchar(10),promotion decimal(11,2),
qtyalert int,img_path varchar(1000),
foreign key(cated_id) references categorydetail(cated_id),foreign key(unit_id) references unit(unit_id),
foreign key(brand_id) references brand(brand_id));

create table productdetail(id int auto_increment primary key,pro_id varchar(30),topic varchar(100),img_path varchar(1000),
review_youtube varchar(1000),content varchar(1000),
foreign key(pro_id) references product(pro_id));

create table func_pro(func_id int auto_increment primary key,func_name varchar(50));

create table function_product(function_id int auto_increment primary key,func_id int,pro_id varchar(30),
content varchar(100),foreign key(func_id) references func_pro(func_id),
foreign key(pro_id) references product(pro_id));

create table product_property(ppy_id int auto_increment primary key,pro_id varchar(30),ppy_name varchar(50),
content varchar(50),foreign key(pro_id) references product(pro_id));

create table product_color(color_id int auto_increment primary key,color_name varchar(50),pro_id varchar(30),
img_path varchar(1000),foreign key(pro_id) references product(pro_id));

create table product_special(spec_id int auto_increment primary key,pro_id varchar(30),content varchar(100),
foreign key(pro_id) references product(pro_id));

create table product_model(model_id int auto_increment primary key,pro_id varchar(30),angle varchar(50),
img_path varchar(1000),foreign key(pro_id) references product(pro_id));

create table orders(order_id int primary key,emp_id varchar(10),sup_id int,amount decimal(11,2),
order_date date,order_time time,status varchar(50),seen1 varchar(30),seen2 varchar(30),user_accept varchar(10),
foreign key(emp_id) references employees(emp_id),foreign key(sup_id) references suppliers(sup_id);

create table orderdetail(detail_id int auto_increment primary key,pro_id varchar(30),qty int, price decimal(11,2),
order_id int,foreign key(pro_id) references product(pro_id),foreign key(order_id) references orders(order_id));

create table listorderdetail(detail_id int auto_increment primary key,pro_id varchar(30),qty int, price decimal(11,2),
order_id int,emp_id varchar(10),foreign key(pro_id) references product(pro_id),foreign key(emp_id) references employees(emp_id));

create table imports(imp_id int auto_increment primary key,imp_bill varchar(30),order_id int,sup_id int,
emp_id varchar(10),pro_id varchar(30),qty int,price decimal(11,2),imp_date date,imp_time time,note varchar(50),
foreign key(order_id) references orders(order_id),foreign key(sup_id) references suppliers(sup_id),
foreign key(emp_id) references employees(emp_id),foreign key(pro_id) references product(pro_id));

create table listimports(imp_id int auto_increment primary key,imp_bill varchar(30),order_id int,sup_id int,
emp_id varchar(10),pro_id varchar(30),qty int,price decimal(11,2),imp_date date,imp_time time,note varchar(50),
foreign key(order_id) references orders(order_id),foreign key(sup_id) references suppliers(sup_id),
foreign key(emp_id) references employees(emp_id),foreign key(pro_id) references product(pro_id));

create table sell(sell_id int primary key,emp_id varchar(10),cus_id int,sell_date date,sell_time time,amount decimal(11,2),
status varchar(50),img_path varchar(1000),sell_type varchar(50),seen1 varchar(50),seen2 varchar(50),cupon_key varchar(30),
cupon_price decimal(11,2),place_deli varchar(100),note varchar(100),
foreign key(cus_id) references customers(cus_id));

create table selldetail(detail_id int auto_increment primary key,pro_id varchar(30),qty int,price decimal(11,2),
promotion decimal(11,2),color_id int,sell_id int,status varchar(50),
foreign key(pro_id) references product(pro_id),foreign key(sell_id) references sell(sell_id));

create table listselldetail(detail_id int auto_increment primary key,pro_id varchar(30),qty int,color_id int,cus_id int,foreign key(pro_id) references product(pro_id),foreign key(cus_id) references customers(cus_id));

create table listselldetail2(detail_id int auto_increment primary key,pro_id varchar(30),qty int,color_id int,emp_id varchar(10),foreign key(pro_id) references product(pro_id),foreign key(emp_id) references employees(emp_id));

select pro_name,sum(d.qty) as total_qty,sum(d.qty*(d.price-d.promotion)) as total,count(d.pro_id) as count_product,p.img_path from selldetail d left join sell s on d.sell_id=s.sell_id left join product p on d.pro_id=p.pro_id group by d.pro_id order by count(d.pro_id) desc;

select pro_name,d.qty,d.price,d.qty*d.price as total,sell_date,s.status,status_cash,sell_type,color_name,unit_name,brand_name,cate_name,cated_name from selldetail d left join sell s on d.sell_id=s.sell_id left join product p on d.pro_id=p.pro_id left join categorydetail i on p.cated_id=i.cated_id left join category c on i.cate_id=c.cate_id left join brand b on p.brand_id=b.brand_id left join unit u on p.unit_id=u.unit_id left join product_color r on d.color_id=r.color_id;

select imp_id,imp_bill,order_id,company,emp_name,i.pro_id,pro_name,unit_name,brand_name,cate_name,cated_name,i.qty,i.price,imp_date,imp_time,note from imports i left join product p on i.pro_id=p.pro_id left join brand b on p.brand_id=b.brand_id left join categorydetail d on p.cated_id=d.cated_id left join unit u on p.unit_id=u.unit_id left join category c on d.cate_id=c.cate_id left join suppliers s on i.sup_id=s.sup_id left join employees e on i.emp_id=e.emp_id;

select pro_name,unit_name,cated_name,cate_name,brand_name,d.qty,d.price,d.qty*d.price as total from orderdetail d left join orders o on d.order_id=o.order_id left join product p on d.pro_id=p.pro_id left join categorydetail l on p.cated_id=l.cated_id left join category c on l.cate_id=c.cate_id left join brand b on p.brand_id=b.brand_id left join unit u on p.unit_id=u.unit_id;

insert into selldetail(pro_id,qty,price,promotion,sell_id) select d.pro_id,d.qty,p.price - p.promotion as newprice,p.promotion,'2' from listselldetail2 d left join product p on d.pro_id=p.pro_id left join categorydetail i on p.cated_id=i.cated_id left join brand b on p.brand_id=b.brand_id left join unit u on p.unit_id=u.unit_id where emp_id='124';